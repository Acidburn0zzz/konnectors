// Generated by CoffeeScript 1.9.0
module.exports = function(log, model, suffix) {
  return function(requiredFields, entries, body, next) {
    entries.filtered = [];
    return model.all(function(err, entryObjects) {
      var entry, entryHash, _i, _len;
      if (err) {
        return next(err);
      }
      entryHash = {};
      for (_i = 0, _len = entryObjects.length; _i < _len; _i++) {
        entry = entryObjects[_i];
        entryHash[entry.date.toISOString()] = entry;
      }
      entries.filtered = entries.fetched.filter(function(entry) {
        return entryHash[entry.date.toISOString()] == null;
      });
      return next();
    });
  };
};
